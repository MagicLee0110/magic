<!DOCTYPE html>
<html>
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
 <meta name="apple-mobile-web-app-capable" content="yes">
 <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
 <style>
    :root {
        --paper: #fffaf0;
        --ink: #2c2c2c;
        --accent: #5d4037;
        --shadow: rgba(0,0,0,0.15);
    }

    body { 
        display: flex; justify-content: center; align-items: center; 
        height: 100vh; margin: 0; padding: 0; 
        background-color: #d1d1d1; /* æ¨¡æ“¬æ·±è‰²æ¡Œé¢ */
        font-family: "Noto Serif TC", "Songti TC", serif; /* å¼·åˆ¶è¥¯ç·šé«” */
        overflow: hidden;
    }
    
    #phone-frame {
        width: 100%; max-width: 414px; height: 100vh; max-height: 800px;
        background: #000; border-radius: 40px; padding: 12px;
        box-shadow: 0 50px 100px rgba(0,0,0,0.5);
        box-sizing: border-box; position: relative;
    }

    /* æ¨¡æ“¬æ‰‹æ©Ÿç‹€æ…‹æ¬„ */
    #status-bar {
        display: flex; justify-content: space-between; padding: 10px 30px 5px;
        color: #666; font-size: 12px; font-family: sans-serif;
    }

    #ebook-page { 
        background-color: var(--paper); 
        height: calc(100% - 40px);
        margin: 0 auto;
        padding: 40px 30px; 
        position: relative; 
        border-radius: 4px 25px 25px 4px; /* æ¨¡æ“¬æ›¸æœ¬å³å´åœ“è§’ */
        box-sizing: border-box;
        overflow: hidden;
    }

    /* æ¨¡æ“¬æ›¸è„Šè£è¨‚å‡¹æ§½èˆ‡é™°å½± */
    #ebook-page::before {
        content: ""; position: absolute; top: 0; left: 0; width: 18px; height: 100%;
        background: linear-gradient(to right, rgba(0,0,0,0.12) 0%, rgba(0,0,0,0.05) 15%, transparent 100%);
        z-index: 10;
    }
    #ebook-page::after {
        content: ""; position: absolute; top: 0; left: 18px; width: 1px; height: 100%;
        background: rgba(0,0,0,0.03); z-index: 10;
    }

    #ebook-header { 
        text-align: center; font-size: 14px; margin-bottom: 35px; 
        color: #999; letter-spacing: 4px; text-transform: uppercase;
    }

    /* è¼¸å…¥å€ UI APP åŒ– */
    #inputSection { background-color: rgba(0,0,0,0.03); padding: 20px 10px; border-radius: 15px; border: 1px solid rgba(0,0,0,0.05); }
    .btn-group { display: flex; justify-content: center; flex-wrap: wrap; margin-bottom: 8px; }
    .small-button { 
        width: 42px; height: 42px; font-size: 20px; margin: 3px; cursor: pointer; 
        border: none; border-radius: 50%; background: white; 
        box-shadow: 0 2px 5px rgba(0,0,0,0.1); transition: 0.2s;
    }
    .small-button:active { transform: scale(0.85); background: var(--accent); color: white; }
    
    input { 
        width: 85%; padding: 12px; border: none; border-bottom: 2px solid #ddd;
        margin: 15px 0; text-align: center; font-size: 20px; 
        background: transparent; font-weight: bold; color: var(--accent);
    }
    
    .calc-btn { 
        background: var(--accent); color: #fff; border: none; 
        padding: 15px 45px; border-radius: 30px; cursor: pointer; 
        font-size: 18px; width: 85%; margin-top: 15px; font-weight: bold;
        box-shadow: 0 4px 15px rgba(93, 64, 55, 0.4);
    }

    /* æ•…äº‹å…§æ–‡å€ï¼šæ¥µè‡´é–±è®€é«”é©— */
    #article { 
        display: none; text-align: justify; line-height: 2.2; 
        font-size: 18px; color: var(--ink); 
        height: 460px; overflow-y: auto; scrollbar-width: none;
    }
    #article::-webkit-scrollbar { display: none; }
    #article p { margin-bottom: 28px; text-indent: 2em; }
    
    #page-number { 
        position: absolute; bottom: 25px; left: 0; right: 0;
        font-size: 12px; text-align: center; color: #bbb; letter-spacing: 2px;
    }
    
    /* éš±å½¢ç¿»é å€ */
    #prevPageButton, #nextPageButton { 
        position: absolute; top: 0; bottom: 0; width: 30%; 
        background: transparent; border: none; cursor: pointer; z-index: 100;
    }
    #prevPageButton { left: 0; }
    #nextPageButton { right: 0; }

    /* ç¿»é å¹³ç§»éæ¸¡ */
    @keyframes slideIn {
        from { opacity: 0; transform: translateX(20px); }
        to { opacity: 1; transform: translateX(0); }
    }
    .page-active { animation: slideIn 0.5s ease-out forwards; }
 </style>
</head>
<body>

<div id="phone-frame">
    <div id="status-bar">
        <span>10:09</span>
        <span><i class="icon">ğŸ“¶ ğŸ”‹ 100%</i></span>
    </div>
    <div id="ebook-page">
      <div id="ebook-header">Chapter 3 â€” å‚³å¥‡è¦‹è­‰éŒ„</div>
      
      <div id="inputSection">
        <div class="btn-group">
          <button class="small-button" onclick="chooseCard('é»‘æ¡ƒ')">â™ </button>
          <button class="small-button" onclick="chooseCard('ç´…å¿ƒ')">â™¥</button>
          <button class="small-button" onclick="chooseCard('æ–¹å¡Š')">â™¦</button>
          <button class="small-button" onclick="chooseCard('æ¢…èŠ±')">â™£</button>
        </div>
        <div class="btn-group">
          <button class="small-button" onclick="chooseCard('A')">A</button>
          <button class="small-button" onclick="chooseNumber('2')">2</button>
          <button class="small-button" onclick="chooseNumber('3')">3</button>
          <button class="small-button" onclick="chooseNumber('4')">4</button>
          <button class="small-button" onclick="chooseNumber('5')">5</button>
          <button class="small-button" onclick="chooseNumber('6')">6</button>
          <button class="small-button" onclick="chooseNumber('7')">7</button>
          <button class="small-button" onclick="chooseNumber('8')">8</button>
          <button class="small-button" onclick="chooseNumber('9')">9</button>
          <button class="small-button" onclick="chooseNumber('0')">0</button>
          <button class="small-button" onclick="chooseCard('J')">J</button>
          <button class="small-button" onclick="chooseCard('Q')">Q</button>
          <button class="small-button" onclick="chooseCard('K')">K</button>
        </div>
        <input type="text" id="cardInput" readonly placeholder="TAP CARD">
        
        <div class="btn-group">
          <button class="small-button" onclick="chooseNum('1')">1</button>
          <button class="small-button" onclick="chooseNum('2')">2</button>
          <button class="small-button" onclick="chooseNum('3')">3</button>
          <button class="small-button" onclick="chooseNum('4')">4</button>
          <button class="small-button" onclick="chooseNum('5')">5</button>
          <button class="small-button" onclick="chooseNum('6')">6</button>
          <button class="small-button" onclick="chooseNum('7')">7</button>
          <button class="small-button" onclick="chooseNum('8')">8</button>
          <button class="small-button" onclick="chooseNum('9')">9</button>
          <button class="small-button" onclick="chooseNum('0')">0</button>
        </div>
        <input type="number" id="number" readonly placeholder="TAP NUMBER">
        <br>
        <button class="calc-btn" onclick="calculate()">å•Ÿå‹•é–±è®€</button>
        <br>
        <button class="clear-button" onclick="clearInput()">RESET</button>
      </div>

      <div id="article">
        <div id="articleContent"></div>
      </div>

      <div id="page-number"></div>
      
      <button id="prevPageButton" onclick="previousPage()" style="display:none"></button>
      <button id="nextPageButton" onclick="nextPage()" style="display:none"></button>
    </div>
</div>

<script>
    var baseStack = [
        {suit:"æ¢…èŠ±",number:"4"},{suit:"ç´…å¿ƒ",number:"2"},{suit:"æ–¹å¡Š",number:"7"},{suit:"æ¢…èŠ±",number:"3"},
        {suit:"ç´…å¿ƒ",number:"4"},{suit:"æ–¹å¡Š",number:"6"},{suit:"é»‘æ¡ƒ",number:"A"},{suit:"ç´…å¿ƒ",number:"5"},
        {suit:"é»‘æ¡ƒ",number:"9"},{suit:"é»‘æ¡ƒ",number:"2"},{suit:"ç´…å¿ƒ",number:"Q"},{suit:"æ–¹å¡Š",number:"3"},
        {suit:"æ¢…èŠ±",number:"Q"},{suit:"ç´…å¿ƒ",number:"8"},{suit:"é»‘æ¡ƒ",number:"6"},{suit:"é»‘æ¡ƒ",number:"5"},
        {suit:"ç´…å¿ƒ",number:"9"},{suit:"æ¢…èŠ±",number:"K"},{suit:"æ–¹å¡Š",number:"2"},{suit:"ç´…å¿ƒ",number:"J"},
        {suit:"é»‘æ¡ƒ",number:"3"},{suit:"é»‘æ¡ƒ",number:"8"},{suit:"ç´…å¿ƒ",number:"6"},{suit:"æ¢…èŠ±",number:"10"},
        {suit:"æ–¹å¡Š",number:"5"},{suit:"æ–¹å¡Š",number:"K"},{suit:"æ¢…èŠ±",number:"2"},{suit:"ç´…å¿ƒ",number:"3"},
        {suit:"æ–¹å¡Š",number:"8"},{suit:"æ¢…èŠ±",number:"5"},{suit:"é»‘æ¡ƒ",number:"K"},{suit:"æ–¹å¡Š",number:"J"},
        {suit:"æ¢…èŠ±",number:"8"},{suit:"é»‘æ¡ƒ",number:"10"},{suit:"ç´…å¿ƒ",number:"K"},{suit:"æ¢…èŠ±",number:"J"},
        {suit:"é»‘æ¡ƒ",number:"7"},{suit:"ç´…å¿ƒ",number:"10"},{suit:"æ–¹å¡Š",number:"A"},{suit:"é»‘æ¡ƒ",number:"4"},
        {suit:"ç´…å¿ƒ",number:"7"},{suit:"æ–¹å¡Š",number:"4"},{suit:"æ¢…èŠ±",number:"A"},{suit:"æ¢…èŠ±",number:"9"},
        {suit:"é»‘æ¡ƒ",number:"J"},{suit:"æ–¹å¡Š",number:"Q"},{suit:"æ¢…èŠ±",number:"7"},{suit:"é»‘æ¡ƒ",number:"Q"},
        {suit:"æ–¹å¡Š",number:"10"},{suit:"æ¢…èŠ±",number:"6"},{suit:"ç´…å¿ƒ",number:"A"},{suit:"æ–¹å¡Š",number:"9"}
    ];

    var allDecks = {};
    for (var i = 0; i < 13; i++) {
        var key = String.fromCharCode(65 + i);
        var offset = i * 4;
        allDecks[key] = baseStack.slice(offset).concat(baseStack.slice(0, offset));
    }

    var globalResultString = "";
    var currentPage = 1;
    var storyBookPage = 37;
    var userNumInput = 0;

    function chooseCard(v) { document.getElementById("cardInput").value += v; }
    function chooseNumber(v) { document.getElementById("cardInput").value += v; }
    function chooseNum(v) { document.getElementById("number").value += v; }
    function clearInput() { document.getElementById("cardInput").value = ""; document.getElementById("number").value = ""; }

    function calculate() {
        var cardVal = document.getElementById("cardInput").value;
        userNumInput = parseInt(document.getElementById("number").value);
        var parsed = parseCard(cardVal);
        if (!parsed || isNaN(userNumInput)) { alert("è«‹è¼¸å…¥ç‰Œçµ„èˆ‡æ•¸å­—ï¼"); return; }

        let found = false;
        for (let key in allDecks) {
            let deck = allDecks[key];
            let pos = getPos(deck, parsed);
            if (pos + 2 === userNumInput) {
                setRes(key, "ç¢ºèªåŒ…å«å…©å¼µå»£å‘Šç‰Œå¾Œ", "èƒŒé¢å‘ä¸‹ä¸€å¼µå¼µå¾€ä¸‹ç™¼", userNumInput);
                found = true; break;
            }
            if (pos === userNumInput) {
                setRes(key, "æ‹¿æ‰é‚£å…©å¼µå»£å‘Šç‰Œå¾Œ", "èƒŒé¢å‘ä¸‹ä¸€å¼µå¼µå¾€ä¸‹ç™¼", userNumInput);
                found = true; break;
            }
            if (55 - pos === userNumInput) {
                setRes(key, "ç¢ºèªåŒ…å«é‚£å…©å¼µé¬¼ç‰Œå¾Œ", "æ­£é¢å‘ä¸Šä¸€å¼µå¼µå¾€ä¸‹ç™¼", userNumInput);
                found = true; break;
            }
            if (53 - pos === userNumInput) {
                setRes(key, "æ‹¿æ‰é‚£å…©å¼µé¬¼ç‰Œå¾Œ", "æ­£é¢å‘ä¸Šä¸€å¼µå¼µå¾€ä¸‹ç™¼", userNumInput);
                found = true; break;
            }
        }
        if(!found) { alert("æ­¤çµ„åˆè¶…å‡ºäº†è¨ˆç®—ç¯„ç–‡ã€‚"); return; }
        document.getElementById("inputSection").style.display = "none";
        document.getElementById("prevPageButton").style.display = "block";
        document.getElementById("nextPageButton").style.display = "block";
        showArticle();
    }

    function setRes(k, act, dir, n) {
        var l = {"A":"çª—å°ä¸Š","B":"æ›¸æ«ƒä¸­é–“","C":"é…’æ«ƒè£¡","D":"è¡£æ«ƒè£¡","E":"æ‰‹æåŒ…å…§","F":"å£è¢‹å…§","G":"æ¤…å­åº•ä¸‹","H":"æ¡Œä¸Šçš„ç›’å­å…§","I":"æ‹›è²¡è²“å¾Œé¢","J":"æ¡Œå­ä¸‹é¢çš„æŠ½å±œ","K":"æ¡Œå­å´é‚Šçš„æŠ½å±œ","L":"é›»è¦–æ­£ä¸‹æ–¹çš„æŠ½å±œ","M":"é›»è¦–æ­£ä¸Šæ–¹çš„æ«ƒå­"};
        globalResultString = `èµ·èº«èµ°åˆ°${l[k]}æ‹¿å‡ºä¸€å‰¯æ’²å…‹ç‰Œä¸¦éçµ¦æˆ‘ã€‚ä»–è«‹æˆ‘å°‡ç‰Œå–å‡ºï¼Œ${act}ï¼Œè®“æˆ‘å¾${dir}åˆ°ç¬¬ 32 å¼µã€‚`;
        storyBookPage = k.charCodeAt(0) - 64 + 30; 
    }

    function getPos(deck, t) {
        for(var i=0; i<deck.length; i++) {
            if(deck[i].suit === t.suit && deck[i].number === t.number) return i + 1;
        }
        return -1;
    }

    function parseCard(input) {
        var m = input.match(/^(é»‘æ¡ƒ|ç´…å¿ƒ|æ–¹å¡Š|æ¢…èŠ±)([2-9]|10|A|J|Q|K)$/);
        return m ? { suit: m[1], number: m[2] } : null;
    }

    function showArticle() {
        var content = document.getElementById("articleContent");
        var pgDisp = document.getElementById("page-number");
        var articleDiv = document.getElementById("article");
        
        articleDiv.scrollTop = 0;
        articleDiv.classList.remove("page-active");
        void articleDiv.offsetWidth; 
        articleDiv.classList.add("page-active");

        if (currentPage === 0) {
            content.innerHTML = `<h2 style="margin-top:180px; text-align:center; color: var(--accent);">Chapter 3 â€” <br>å¤§è¡›Â·å·´æ ¼æ‹‰æ–¯</h2>`;
            pgDisp.innerHTML = "";
        } else if (currentPage === 1) {
            content.innerHTML = `<p>å¤§è¡›Â·å·´æ ¼æ‹‰æ–¯ï¼ˆDavid Berglasï¼‰æ˜¯ä¸€ä½å‚³å¥‡äººç‰©ã€‚åœ¨é­”è¡“ç•Œï¼Œä»–çš„åå­—å¹¾ä¹èˆ‡ã€Œä¸å¯èƒ½ã€åŠƒä¸Šç­‰è™Ÿã€‚</p><p>ä»–å‰µé€ çš„ ACAAN æ•ˆæœè¢«è­½ç‚ºé­”è¡“ç•Œçš„è–æ¯ã€‚è€Œåœ¨æˆ‘çœ‹ä¾†ï¼Œé‚£æ›´åƒæ˜¯ä¸€å ´ç²¾å¿ƒç·¨ç¹”çš„å¿ƒç†åšå¼ˆã€‚</p><div style="text-align:center; margin: 30px 0;"><img src="book1.jpg" style="width:90%; border-radius:4px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);"></div><p>å¤§è¡›å¸¸èªªï¼ŒçœŸæ­£çš„é­”æ³•ä¸¦éç™¼ç”Ÿåœ¨æ‰‹ä¸­ï¼Œè€Œæ˜¯ç™¼ç”Ÿåœ¨è§€çœ¾çš„è…¦æµ·ä¸­ã€‚</p>`;
            pgDisp.innerHTML = `â€” ${storyBookPage - 1} â€”`;
        } else if (currentPage === 2) {
            content.innerHTML = `
                <p>æ•…äº‹ç™¼ç”Ÿåœ¨ 1976 å¹´çš„å€«æ•¦ã€‚ç•¶æ™‚æˆ‘å·²èªè­˜å¤§è¡›å¤šå¹´ï¼Œä½†å§‹çµ‚æœªèƒ½è¦ªç¹é‚£å€‹æ•ˆæœçš„çœŸé¢ç›®ã€‚ç›´åˆ°é‚£æ™šï¼Œå¤§è¡›é‚€è«‹æˆ‘å»ä»–å®¶è£¡ä½œå®¢ã€‚</p>
                <p>æˆ‘å€‘ååœ¨å……æ»¿è€æ´¾æ°£æ¯çš„æ›¸æˆ¿è£¡ï¼Œå£çˆçš„ç«å…‰æ–æ›³ã€‚å¤§è¡›çªç„¶ç›´è¦–è‘—æˆ‘çš„çœ¼ç›èªªï¼šã€Œéš¨æ„èªªå‡ºä¸€å¼µç‰Œï¼Œä»¥åŠä¸€å€‹ 1 åˆ° 52 ä¹‹é–“çš„æ•¸å­—ã€‚ã€</p>
                <p>æˆ‘ä¸å‡æ€ç´¢åœ°å›ç­”ï¼šã€Œæ–¹å¡Š 5ï¼Œ32ã€ã€‚</p>
                <p>å¤§è¡›åˆ†äº«äº†ä¸€å€‹è¶£èå¾Œï¼Œä¾¿ç·©ç·©èµ·èº«ï¼Œ${globalResultString} æˆ‘ä¸€å¼µä¸€å¼µç™¼è‘—ç‰Œï¼Œæ•¸åˆ°ç¬¬ 32 å¼µï¼ŒæŒ‡å°–ç”šè‡³èƒ½æ„Ÿå—åˆ°ç©ºæ°£ä¸­çš„ç·Šå¼µæ„Ÿ...</p>
                <p>ä½ çŸ¥é“çš„ï¼Œé‚£å¼µç‰Œæ­£æ˜¯ã€Œæ–¹å¡Š 5ã€ï¼ï¼ï¼</p>
                <p>æˆ‘æ°¸é å¿˜ä¸äº†å¤§è¡›ç•¶æ™‚çš„è¡¨æƒ…ï¼Œé‚£ç¨®æ·¡ç„¶è€Œç¥ç§˜çš„å¾®ç¬‘ã€‚é€™å°±æ˜¯å‚³èªªä¸­çš„ã€Œå·´æ ¼æ‹‰æ–¯æ•ˆæœã€ã€‚</p>
            `;
            pgDisp.innerHTML = `â€” ${storyBookPage} â€”`;
        } else if (currentPage === 3) {
            content.innerHTML = `<p style="margin-top:200px; text-align:center; font-style:italic; color: #777;">ã€Œæˆ‘æ°¸é å¿˜ä¸äº†é‚£å€‹ç”·äºº......æ°¸é ã€‚ã€</p>`;
            pgDisp.innerHTML = `â€” ${storyBookPage + 1} â€”`;
        } else if (currentPage === 4) {
            content.innerHTML = `<h2 style="margin-top:180px; text-align:center; color: var(--accent);">Chapter 4 â€” <br>æœªç«Ÿçš„å¥‡è¹Ÿ</h2>`;
            pgDisp.innerHTML = "";
        }
        articleDiv.style.display = "block";
    }

    function previousPage() { if (currentPage > 0) { currentPage--; showArticle(); } }
    function nextPage() { if (currentPage < 4) { currentPage++; showArticle(); } }

    document.addEventListener("keydown", e => { if (e.keyCode == 123 || (e.ctrlKey && e.key.toLowerCase() === 'u')) e.preventDefault(); });
    document.addEventListener("contextmenu", e => e.preventDefault());
</script>
</body>
</html>
