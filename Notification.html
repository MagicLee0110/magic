<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="Notification.png">
    <link rel="icon" href="Notification.png" type="image/png">
    <title>iOS Magic Pro - Multi-Set Full</title>
    <style>
        :root {
            --ios-font: -apple-system, BlinkMacSystemFont, "SF Pro Text", "SF Pro Display", "Helvetica Neue", Arial, sans-serif;
            --handwriting-font: "Cursive", "Bradley Hand", "Marker Felt", "Chalkboard SE", sans-serif;
            --main-gradient: linear-gradient(180deg, #000000 0%, #1a152e 40%, #000000 100%);
            --accent-color: #d4a017;
        }

        html, body {
            margin: 0; padding: 0; width: 100%; height: 100%;
            font-family: var(--ios-font);
            overflow: hidden;
            background-color: #000;
            touch-action: none; 
        }

        /* --- é€šçŸ¥ä¸­å¿ƒ --- */
        #notification-center {
            width: 100%; height: 100%;
            background: var(--main-gradient);
            background-attachment: fixed;
            position: relative;
            color: white;
            display: flex;
            flex-direction: column;
        }

        .top-content { flex: 0 0 auto; z-index: 10; }

        .clock-container {
            text-align: center;
            padding-top: calc(env(safe-area-inset-top) + 60px);
            user-select: none;
            -webkit-user-select: none;
        }
        .time-text { font-size: 95px; font-weight: 200; margin: 0; letter-spacing: -2px; }
        .date-text { font-size: 19px; opacity: 0.9; }

        .notification-header { padding: 40px 25px 15px; font-size: 28px; font-weight: 600; }

        .notification-list { padding: 0 15px; }
        .notif-card {
            background: rgba(40, 40, 40, 0.4);
            backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px);
            border-radius: 24px; padding: 15px; margin-bottom: 12px;
            display: flex; flex-direction: column;
        }
        .notif-top { display: flex; gap: 12px; }
        .notif-content { flex: 1; }
        .notif-title-row { display: flex; justify-content: space-between; font-size: 15px; font-weight: 600; }
        .notif-body { font-size: 14px; line-height: 1.4; opacity: 0.9; }

        /* --- ä¹å®®æ ¼ --- */
        .magic-area {
            flex: 1;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            z-index: 999;
            margin-bottom: 40px;
        }
        .magic-btn { width: 100%; height: 100%; background: transparent; }

        /* --- å‚™å¿˜éŒ„ --- */
        #memo-screen {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: #000; color: #fff;
            display: none; flex-direction: column; z-index: 2000;
        }
        .memo-header { padding: calc(env(safe-area-inset-top) + 10px) 20px 10px; display: flex; justify-content: space-between; align-items: center; color: var(--accent-color); font-size: 17px; z-index: 2010; }
        
        .memo-content-area {
            flex: 1; position: relative; width: 100%;
            display: flex; justify-content: center; align-items: center;
        }
        
        #handwritingNumber {
            font-family: var(--handwriting-font);
            font-size: 220px; 
            font-weight: 500;
            color: rgba(255, 255, 255, 0.95);
            z-index: 2001;
            user-select: none;
        }

        #sketchCanvas {
            position: absolute; top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 2005;
        }

        /* --- å¾Œå°æ§åˆ¶ä¸­å¿ƒ --- */
        #backstage-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.98); color: white;
            display: none; flex-direction: column; z-index: 3000;
            padding: calc(env(safe-area-inset-top) + 20px) 20px;
            box-sizing: border-box;
            overflow-y: auto;
        }

        .backstage-title { font-size: 22px; font-weight: bold; margin-bottom: 20px; text-align: center; color: var(--accent-color); }

        .set-selector { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 20px; border-bottom: 1px solid #333; padding-bottom: 15px; }
        .set-tab { 
            padding: 8px 15px; background: #222; border: 1px solid #444; border-radius: 20px; font-size: 14px; 
            color: #888; transition: 0.2s;
        }
        .set-tab.active { background: var(--accent-color); color: black; border-color: var(--accent-color); font-weight: bold; }
        .add-set-btn { padding: 8px 15px; background: #333; border: 1px dashed #666; border-radius: 20px; font-size: 14px; color: #fff; }

        .edit-section { background: rgba(255,255,255,0.05); padding: 15px; border-radius: 15px; }
        .name-input-group { margin-bottom: 15px; }
        .name-input-group label { display: block; font-size: 12px; color: #888; margin-bottom: 5px; }
        .name-input { background: transparent; border: none; border-bottom: 1px solid #555; color: white; font-size: 18px; width: 100%; padding: 5px 0; outline: none; }
        .name-input:focus { border-bottom-color: var(--accent-color); }

        .grid-inputs { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 10px; }
        .grid-inputs input { background: #111; border: 1px solid #333; color: white; padding: 12px 5px; border-radius: 8px; text-align: center; font-size: 16px; width: 100%; box-sizing: border-box; }

        .action-buttons { margin-top: 25px; display: flex; gap: 10px; }
        .save-btn { background: var(--accent-color); color: black; border: none; padding: 15px; border-radius: 12px; font-size: 16px; font-weight: bold; flex: 2; }
        .delete-btn { background: #ff3b30; color: white; border: none; padding: 15px; border-radius: 12px; font-size: 16px; font-weight: bold; flex: 1; }

        .home-bar { position: fixed; bottom: 8px; left: 50%; transform: translateX(-50%); width: 140px; height: 5px; background: rgba(255, 255, 255, 0.3); border-radius: 10px; z-index: 4000; }
    </style>
</head>
<body>

    <div id="notification-center">
        <div class="top-content">
            <div class="clock-container" id="clockZone" onclick="openMemo(null)">
                <div class="date-text" id="dateDisplay">1æœˆ3æ—¥ é€±å…­</div>
                <h1 class="time-text" id="timeDisplay">15:02</h1>
            </div>
            <div class="notification-header">é€šçŸ¥ä¸­å¿ƒ</div>
            
            <div class="notification-list">
                <div class="notif-card">
                    <div class="notif-top">
                        <div style="width:38px; height:38px; background:#ff4500; border-radius:8px; display:flex; align-items:center; justify-content:center; font-weight:bold;">S</div>
                        <div class="notif-content">
                            <div class="notif-title-row"><span>æ‚¨é—œæ³¨çš„è³£å®¶é–‹å§‹ç›´æ’­äº†ï¼</span><span style="opacity:0.6; font-size:13px;">1å°æ™‚å‰</span></div>
                            <div class="notif-body">è§€çœ‹ Yomigirls çš„ç›´æ’­ï¼šç¥ç¾æµ©è‚¯åŒ…ğŸ¤©...</div>
                        </div>
                    </div>
                </div>
                <div class="notif-card">
                    <div class="notif-top">
                        <div style="width:38px; height:38px; background:#006aa6; border-radius:8px; display:flex; align-items:center; justify-content:center; font-weight:bold;">D</div>
                        <div class="notif-content">
                            <div class="notif-title-row"><span>ä½ è¿½è¹¤çš„ã€Œç†è²¡æ¿ã€æ–°æ–‡ç« </span><span style="opacity:0.6; font-size:13px;">2å°æ™‚å‰</span></div>
                            <div class="notif-body">ã€Œå°è‚¡ç˜‹äº† æ­£äºŒä¹Ÿç˜‹äº†ã€</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="magic-area">
            <div class="magic-btn" onclick="openMemo(0)"></div>
            <div class="magic-btn" onclick="openMemo(1)"></div>
            <div class="magic-btn" onclick="openMemo(2)"></div>
            <div class="magic-btn" onclick="openMemo(3)"></div>
            <div class="magic-btn" onclick="openMemo(4)"></div>
            <div class="magic-btn" onclick="openMemo(5)"></div>
            <div class="magic-btn" onclick="openMemo(6)"></div>
            <div class="magic-btn" onclick="openMemo(7)"></div>
            <div class="magic-btn" onclick="openMemo(8)"></div>
        </div>
        <div class="home-bar"></div>
    </div>

    <div id="memo-screen">
        <div class="memo-header">
            <span onclick="closeMemo()">ï¼œ å‚™å¿˜éŒ„</span>
            <span style="font-weight:600;" onclick="closeMemo()">å®Œæˆ</span>
        </div>
        <div class="memo-content-area">
            <div id="handwritingNumber"></div>
            <canvas id="sketchCanvas"></canvas>
        </div>
        <div class="home-bar"></div>
    </div>

    <div id="backstage-screen">
        <div class="backstage-title">æ•¸å­—é›†ç®¡ç†ä¸­å¿ƒ</div>
        <div class="set-selector" id="setSelector"></div>
        <div class="edit-section">
            <div class="name-input-group">
                <label>è¨­å®šåç¨±</label>
                <input type="text" id="currentSetName" class="name-input" placeholder="ä¾‹å¦‚ï¼šé è¨­æ•¸å€¼">
            </div>
            <div class="grid-inputs" id="inputContainer"></div>
        </div>
        <div class="action-buttons">
            <button class="save-btn" onclick="saveAllAndClose()">å„²å­˜ä¸¦é—œé–‰</button>
            <button class="delete-btn" onclick="deleteCurrentSet()">åˆªé™¤</button>
        </div>
        <div class="home-bar" onclick="document.getElementById('backstage-screen').style.display='none'"></div>
    </div>

    <script>
        let config = {
            activeIndex: 0,
            sets: [
                { name: "é è¨­æ•¸å€¼", values: ["198", "297", "396", "495", "594", "693", "792", "891", "99"] }
            ]
        };

        const savedConfig = localStorage.getItem('magicConfig_v2');
        if (savedConfig) config = JSON.parse(savedConfig);

        function renderBackstage() {
            const selector = document.getElementById('setSelector');
            selector.innerHTML = '';
            config.sets.forEach((set, index) => {
                const tab = document.createElement('div');
                tab.className = `set-tab ${index === config.activeIndex ? 'active' : ''}`;
                tab.textContent = set.name;
                tab.onclick = () => switchSet(index);
                selector.appendChild(tab);
            });
            const addBtn = document.createElement('div');
            addBtn.className = 'add-set-btn';
            addBtn.textContent = '+ æ–°å¢çµ„åˆ¥';
            addBtn.onclick = addNewSet;
            selector.appendChild(addBtn);

            const currentSet = config.sets[config.activeIndex];
            document.getElementById('currentSetName').value = currentSet.name;
            const container = document.getElementById('inputContainer');
            container.innerHTML = '';
            currentSet.values.forEach((val, i) => {
                const input = document.createElement('input');
                input.type = 'text'; input.value = val;
                input.oninput = (e) => { currentSet.values[i] = e.target.value; };
                container.appendChild(input);
            });
        }

        function switchSet(index) { saveTempData(); config.activeIndex = index; renderBackstage(); }
        function addNewSet() {
            saveTempData();
            config.sets.push({ name: "æ–°è¨­å®š " + (config.sets.length + 1), values: ["", "", "", "", "", "", "", "", ""] });
            config.activeIndex = config.sets.length - 1;
            renderBackstage();
        }
        function deleteCurrentSet() {
            if (config.sets.length <= 1) return;
            if (confirm("ç¢ºå®šåˆªé™¤ï¼Ÿ")) { config.sets.splice(config.activeIndex, 1); config.activeIndex = 0; renderBackstage(); }
        }
        function saveTempData() { config.sets[config.activeIndex].name = document.getElementById('currentSetName').value; }
        function saveAllAndClose() {
            saveTempData();
            localStorage.setItem('magicConfig_v2', JSON.stringify(config));
            document.getElementById('backstage-screen').style.display = 'none';
        }

        let pressTimer;
        document.getElementById('clockZone').addEventListener('touchstart', (e) => {
            pressTimer = setTimeout(() => { renderBackstage(); document.getElementById('backstage-screen').style.display = 'flex'; }, 1500);
        });
        document.getElementById('clockZone').addEventListener('touchend', () => clearTimeout(pressTimer));

        const canvas = document.getElementById('sketchCanvas');
        const ctx = canvas.getContext('2d');
        let drawing = false;

        function initCanvas() {
            canvas.width = window.innerWidth; canvas.height = window.innerHeight;
            ctx.strokeStyle = "rgba(255, 255, 255, 0.95)"; ctx.lineWidth = 10;
            ctx.lineCap = "round"; ctx.lineJoin = "round";
        }
        window.addEventListener('resize', initCanvas);
        initCanvas();

        function draw(e) {
            if (!drawing) return;
            const x = e.touches ? e.touches[0].clientX : e.clientX;
            const y = e.touches ? e.touches[0].clientY : e.clientY;
            ctx.lineTo(x, y); ctx.stroke(); ctx.beginPath(); ctx.moveTo(x, y);
        }
        canvas.addEventListener('touchstart', (e) => { e.preventDefault(); drawing = true; draw(e); });
        canvas.addEventListener('touchmove', (e) => { e.preventDefault(); draw(e); });
        canvas.addEventListener('touchend', () => { drawing = false; ctx.beginPath(); });

        function openMemo(index) {
            document.getElementById('notification-center').style.display = 'none';
            document.getElementById('memo-screen').style.display = 'flex';
            if (index === null) {
                document.getElementById('handwritingNumber').style.display = 'none';
                canvas.style.display = 'block';
                ctx.clearRect(0, 0, canvas.width, canvas.height); 
            } else {
                document.getElementById('handwritingNumber').textContent = config.sets[config.activeIndex].values[index];
                document.getElementById('handwritingNumber').style.display = 'block';
                canvas.style.display = 'none';
            }
        }

        function closeMemo() {
            document.getElementById('memo-screen').style.display = 'none';
            document.getElementById('notification-center').style.display = 'flex';
        }

        function updateClock() {
            const now = new Date();
            document.getElementById('timeDisplay').textContent = now.getHours().toString().padStart(2, '0') + ":" + now.getMinutes().toString().padStart(2, '0');
            const weekDays = ["é€±æ—¥", "é€±ä¸€", "é€±äºŒ", "é€±ä¸‰", "é€±å››", "é€±äº”", "é€±å…­"];
            document.getElementById('dateDisplay').textContent = `${now.getMonth() + 1}æœˆ${now.getDate()}æ—¥ ${weekDays[now.getDay()]} Â· ä¹™å·³å¹´å†¬æœˆåäº”`;
        }
        setInterval(updateClock, 1000); updateClock();
    </script>
</body>
</html>
